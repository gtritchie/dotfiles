#!/usr/bin/env bash

sudo rstudio-server stop

# copy compiled stuff into RSP installation

COPY_SOURCE=~/rstudio-pro/src/cpp/cmake-build-debug
COPY_DEST=/usr/lib/rstudio-server

sudo cp -v $COPY_SOURCE/server/rserver $COPY_DEST/bin/rserver
sudo cp -v $COPY_SOURCE/session/rsession $COPY_DEST/bin/rsession
sudo cp -v $COPY_SOURCE/session/workspaces/rworkspaces $COPY_DEST/bin/rworkspaces
sudo cp -v $COPY_SOURCE/session/modules/R/JobLauncher.R $COPY_DEST/R/modules
sudo cp -v $COPY_SOURCE/session/modules/R/SessionOverlay.R $COPY_DEST/R/modules

COPY_SOURCE=~/rstudio-pro/src/cpp/session/workspaces

sudo rm -rf $COPY_DEST/www-workspaces
sudo cp -vR $COPY_SOURCE/www-workspaces $COPY_DEST

echo Done

