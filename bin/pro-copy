#!/usr/bin/env bash

sudo rstudio-server stop
pkill rserver 
pkill rsession
pkill rworkspaces

# copy compiled stuff into RSP installation

COPY_SOURCE=~/rstudio-pro/src/cpp/cmake-build-debug
COPY_DEST=/usr/lib/rstudio-server

sudo cp -v $COPY_SOURCE/server/rserver $COPY_DEST/bin/rserver
sudo cp -v $COPY_SOURCE/session/rsession $COPY_DEST/bin/rsession
sudo cp -v $COPY_SOURCE/session/workspaces/rworkspaces $COPY_DEST/bin/rworkspaces
sudo cp -v $COPY_SOURCE/session/modules/R/JobLauncher.R $COPY_DEST/R/modules
sudo cp -v $COPY_SOURCE/session/modules/R/SessionOverlay.R $COPY_DEST/R/modules
sudo cp -v $COPY_SOURCE/session/modules/R/SessionJobs.R $COPY_DEST/R/modules

# launcher
#sudo cp -v $COPY_SOURCE/job_launcher/rstudio-launcher $COPY_DEST/bin/rstudio-launcher
#sudo cp -v $COPY_SOURCE/job_launcher/impls/local/rstudio-local-launcher $COPY_DEST/bin/rstudio-local-launcher
#sudo cp -v $COPY_SOURCE/job_launcher/impls/kubernetes/rstudio-kubernetes-launcher $COPY_DEST/bin/rstudio-kubernetes-launcher

echo Done

